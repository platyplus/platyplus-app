- args:
    cascade: false
    sql: |-
      Create view public.state_derived as
      select id, coalesce(lag(date_start, -1) over (order by date_start), 'infinity') as date_end from public.state;
  type: run_sql
- args:
    name: state_derived
    schema: public
  type: add_existing_table_or_view
